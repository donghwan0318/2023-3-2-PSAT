---
title: "딥러닝팀_클린업2주차"
author: "Donghwan Kim"
date: "2023-09-17"
output: 
  html_document :
      toc : true
      toc_float : true
      code_folding : show
---

# Chapter 0 : Theory

```{r include=FALSE}
install.packages("readstata13",repos="http://cran.us.r-project.org")
install.packages("tidyverse",repos="http://cran.us.r-project.org")
library(readstata13)
library(tidyverse)
library(magrittr)
library(stats)
library(gridExtra)
```


## 문제 1
F-값은 다음과 같이 구할 수 있다.
$$F = \frac{MSR}{MSE}$$
$$R^2 = \frac{SSR}{SST} = 1-\frac{SSE}{SST}$$

$\frac{SSR}{SST}$ = 0.201, $\frac{SSE}{SST}$ = 0.799 를 이용하여 $F=\frac{MSR}{MSE}=\frac{SSR/4}{SSE/676}$ 를 구하면 `r (0.201/4)/(0.799/676)` 이다. F(4,676)에서 누적확률이 0.95가 되는 f값은 `r qf(0.95,4,676)` 임으로 유의수준 0.05 하에서 F검정 결과 회귀모델이 통계적으로 유의하다. --> t-test를 실시한다.

회귀계수의 t-value에 대한 가설은 다음과 같다.

- null hypothesis ($H_0$) : $\beta_i=0$
- alternative hypothesis ($H_1$) : $\beta_i\neq0$

t-value 는 다음과 같이 추정한다

$t_\beta = \frac{\beta_i}{s.e(\beta_i)}$

각 회귀계수들의 t-value를 구하면

- Atndrte = -0.021 / 0.002 = `r -0.021 / 0.002` 
- Stndmid = 0.082 / 0.011  = `r 0.082 / 0.011 `
- priGPA = -0.555 / 0.078 = `r -0.555 / 0.078`
- Atndrte*priGPA = 0.011 / 0.004 = `r 0.011 / 0.004`

자유도는 n-p-1 (p는 회귀계수들의 갯수) 로 일반적으로 구하지만

$\beta_0$  인 intercept term이 없음으로

d.f = 680-4 = 676

자유도가 676인 t분포에서 , 누적확률이 0.95가 되는 확률변수 t값은

95 percentile of t-distribution : `r qt(0.95 ,676)`

따라서 모든 회귀계수는 유의 수준 0.05에서 유의하다.


## 문제 2

measurement error가 independent variable에 존재하는 경우 우리가 추정하려는 식은 다음과 같다.

$$y = \beta_1*x_1^* + \beta_2*x_2 + \beta_3*x_3 + \beta_4*x_1*x_3 + (\epsilon - \beta_1*\mu_1)  -(1)$$

측정오류가 미치는 영향은 다음과 같다.

- $\mu_1$은 measurement error 임으로 $N(0,\sigma^2_\mu)$ 을 따른다고 가정한다. 이 때 $\epsilon ~ N(0,\sigma^2_\epsilon)$ 임으로 (1) 에서 새로운 error term의 분산은 $\sigma^2_\epsilon + \beta_1^2\sigma^2_\mu$ 인 것을 알 수 있다. 즉 모델의 분산이 더 커진다. 

- 회귀식을 OLS로 추정할 때 $x_i$ 와 $\epsilon$ 은 서로 독립이라고 가정하지만, 독립 변수에 측정 오류가 있을 경우 $x_i$ 들과 $\sigma^2_\mu$ 들이 독립일 경우와 독립이 아닐 경우로 나눠진다.
  - 서로 독립 일 경우 : 여전히 외생성을 유지함으로, OLS를 통해 추정하여도 회귀계수들에는 편향이 없다.
  
  - 서로 독립이 아닐 경우 : Omitted Variable Bias 가 발생할 수 있다. 회귀계수가 편향된다는 것은 측정 오류로 인해 독립변수의 실제 효과가 왜곡될 수 있음을 의미한다.  
  - Omitted Variable Bias : 다중 회귀 분석에서 종속변수를 설명하기 위한 중요한 독립변수이나, 모형에서 누락되어 오차항에 포함되었을 때 발생하는 편향을 의미함.

즉 서로 독립이 아닐 경우에는 편향이 발생하여 계수의 효과 크기가 왜곡 될 수 있고, 표준 오차가 증가하며, 결과적으로 모델의 설명력이 하락한다.

## 문제 3

추정된 회귀식에 따르면 기말고사와 출석률에 대한 회귀계수는 음수로 서로 음의 상관관계가 있다고 판단할 수 있다. 그러나 120명의 학생의 출석률과 기말고사 사이에 양의 상관관계가 존재한다면 지금의 회귀계수는 양의 방향으로 움직일 수도 있다. 반대로 120명의 학생의 출석률과 기말고사 사이에 마찬가지로 음의 상관이 존재한다면 현재 회귀계수가 유지되거나 더 낮아질 수 있다. 회귀식을 추정하는데 사용된 680명의 표본이 전체 표본을 대표 할 수 있다면 회귀계수에는 크게 차이가 없을 것이고 그렇지 않다면 변화가 있을 것이다.

## 문제 4

- stndmid : 출석률과 어떤 관계가 있는지 판단할 만한 자료가 부족하다.

- priGPA : 출석률 변수가 유의하고 출석률과 이전학기 성적의 교호작용 변수가 유의한 것을 보아 출석률이 기말고사성적에 영향을 미치는데 그 정도가 이전학기 성적에 따라 다르다고 판단 할 수 있다.

- atndre : 잠재변수로 고려 할 만한 것은 다음과 같다.
  1. 거주지와 학교와의 거리
  1. 1교시 ( 이른 시간을 의미) 수업인지
  1. 몇 학년 대상 과목인지 - 부연 설명을 하자면 처음 통계를 배울 때는 아무래도 내공(?)이 없으니까 실력편차가 좀 많이 심할 수 있고, 저학년이다보니 실력편차에서 하위에 있을 경우 그냥 놀자라고 생각하거나 남학생일 경우 군대갔다와서 잘해야겠다 등등 을 생각 해서 던져버릴 수 있으니까 고려해볼 만 하다고 생각했음.
  1. 대형 강의 인지 여부 - 아무래도 사람수가 적은 수업보다는 70명,100명 씩 하는 대형 강의가 출튀하기도 좋고 도망가기도 좋기 때문에 고려해볼 만 하다고 생각함.
  1. 월요일 혹은 금요일 수업 인지 여부 - 애매 하긴 한데, 월요일 1교시면 안가고 싶지 않을까하는 생각과 금요일이면 그냥 자체 공강때리고 학교 안가는 사람도 있으니까.
  1. 복수 전공인지 원전공인지 여부
  
  
## 문제 5

일반적으로 생각하면 출석률과 기말고사 성적은 양의 상관관계를 가지고 있어야하는데, 추정된 회귀식은 -0.021로 음수이다. 이것의 원인은 문제2 에서 제시된 출튀이고, 출석률에서 거리를 분리해도 출튀문제가 반영된 변수는 아니기 때문에 여전히 회귀계수는 dist와 atndre모두 음수 일 것 같다. 


# Chapter 1 : Data Processing & Background

## 문제 1


```{r warning=FALSE}
# 데이터 불러오기
setwd("D:/3학년/2학기/32기피셋/클린업/2주차/[23년도 2학기]클린업 2주차 패키지/data")
goms17 <- read.dta13("goms2017.dta")
goms18 <- read.dta13("goms2018.dta")
goms16_col <- read.dta13("goms_col_16.dta")
goms17_col <- read.dta13("goms_col_17.dta")
```

## 문제 2

```{r}
goms17 %<>% select(g161pid:g161gradum,c("g161f","g161p") %>% starts_with)
goms18 %<>% select(g171pid:g171gradum,c("g171f","g171p") %>% starts_with)
```

## 문제 3

```{r}
#필요한 열 선택하고 나머지 지우기
#추후 병합할 예정
goms17_161f <- goms17 %>% select(g161f001:g161f017,g161f170)
goms18_171f <- goms18 %>% select(g171f001:g171f017)
goms17 %<>% select(-starts_with("g161f"))
goms18 %<>% select(-starts_with("g171f")) 
```

## 문제 4

```{r}
#필요한 열 선택하고 나머지 지우기
#추후 병합할 예정
goms17_161p <- goms17 %>% select(g161p018:g161p036)
goms18_171p <- goms18 %>% select(g171p018:g171p036)
goms17 %<>%  select(-starts_with("g161p"),g161pid)
goms18 %<>%  select(-starts_with("g171p"),g171pid) 
```

## 문제 5

```{r}
goms18 %<>% select(-c(g171dpmt_n,g171major_n))
```

## 문제 6

```{r}
# 문제 3,4 한거 병합
goms17 <- bind_cols(goms17_161f,goms17_161p,goms17)
goms18 <- bind_cols(goms18_171f,goms18_171p,goms18)
# id 기준으로 병합
goms17 <- left_join(goms17,goms16_col %>% select(pid,colnam),by=c("g161pid"="pid"))
goms18 <- left_join(goms18,goms17_col %>% select(pid,colnam),by=c("g171pid"="pid"))
```

## 문제 7

```{r}
# 앞에 붙은 접두사 제거하기
goms17 %<>% rename_with(~gsub("g161","",.))
goms18 %<>% rename_with(~gsub("g171","",.))
```

## 문제 8

```{r}
# 싹다 병합하기
goms17 %<>% mutate(year = "2017")
goms18 %<>% mutate(year = "2018")
data <- bind_rows(goms17,goms18)
```

## 문제 9

```{r}
# 4년제만 선택
data %<>% filter(school=='4년제')
# 전처리 된거 확인인
data %>% select(school) %>% unique
```
## 문제 10

```{r}
# 1988~1994 출생자 선택
data %<>% filter(birthy>=1988 & birthy <=1994)
# 전처리 확인
data %>% select(birthy) %>% unique
```

## 보너스 문제 1


이 연구의 가설에서 주장하는 2가지는 다음과 같은데, 

1. "입시전형에 관계없이 가족의 사회경제적 배경이 높을 수록 상위권 대학 진학의 확률이 커진다." 
1. "그 정도는 입시전형마다 다르다."

이 두 가지를 확인하기 위해서는

1. 입시전형을 고정한 상태로 모든 입시전형에 대하여 가족의 사회경제적 배경이 상위권 대학 진학에 양의 영향을 미치는지 확인하고
1. 입시전형 별로 상위권 대학 진학에 영향을 미치는 정도에 차이가 있는지 확인해야한다.

그러나 입학사정관제와 학생부 종합 전형 사이에 이질적인 차이가 존재함에도 이를 구분하지 않고 연구에 포함하면 입시전형의 효과가 왜곡될 것이다. 이 두 전형을 동시에 연구 대상에 포함하면, 가족의 사회경제적 배경 뿐만 아니라 두 전형 간의 차이로 인한 영향도 함께 반영될 수 있을 것이며, 그에 따라 연구 결과에서 "그 정도가 입시전형마다 다른지"를 명확하게 확인하기 어렵게 된다.


## 문제 11

```{r}
# 졸업시기와 대학입학 시기 간견이 3년 이상인 경우 제거
data %<>% filter(f011-f001<3)
# 전처리 확인
data %>% filter(f011-f001 >= 3) %>% dim
```

## 문제 12

```{r}
# 편입일 경우 제거
data %<>% filter(f010!="편입") 
# 전처리 확인
data %>% filter(f010=="편입") %>% dim
```

## 문제 13

```{r}
# 상위권 대학교는 1로 나머지는 0 으로 변경
target_univ<-c("경희대학교","고려대학교","서강대학교","서울대학교","서울시립대학교","성균관대학교","연세대학교","이화여대학교","중앙대학교","한국외국어대학교","한양대학교","한국과학기술원","포항공과대학교")
data %<>% mutate(colnam = ifelse((colnam %in% target_univ | majorcat =="의약"),1,0))
# 전처리 확인
data %>% filter(colnam==1) %>% dim
```

## 문제 14

```{r message=FALSE}
# p034 모름/무응답 제거하기
data %<>% filter(p034!="모름/무응답") 
# 소득분위 중위값으로 대체하기
data %<>% mutate(
  p034 = case_when(
    p034 == "1,000만원 이상" ~1000,
    p034 == "700~1,000만원 미만" ~ 850,
    p034 == "500~700만원 미만" ~ 600,
    p034 == "400~500만원 미만" ~ 450,
    p034 == "300~400만원 미만" ~ 350,
    p034 == "200~300만원 미만" ~ 250,
    p034 == "100~200만원 미만" ~ 150,
    p034 == "100만원 미만" ~ 50,
    p034 == "소득없음" ~ 0,
    p034 == "안계심(사망)" ~ 0,
    )
  ) 
# 백분위 구하고 잘 변경되나 확인
data %>% group_by(f011) %>% mutate(p034 = (rank(p034)/n()*100) %>% round(0)) %>% ungroup %>% select(f011,p034) %>% head(3)

```

```{r}
# 분위값으로 대체하기
data %<>% group_by(f011) %>% mutate(p034 = (rank(p034)/n()*100) %>% round(0)) %>% ungroup
```

## 문제 15

```{r}
data %>% select(p036) %>% unique
# 모름/무응답 제거
data %<>% filter(p036!="모름/무응답") 
# 부모 자산 정도 중위값 대체하기
data %<>% mutate(
  p036 = case_when(
    p036 == "10억 원 이상" ~10,
    p036 == "5억 원 ~ 10억 원 미만" ~ 7.5,
    p036 == "3억 원 ~ 5억 원 미만" ~ 4,
    p036 == "1억 5천만 원 ~ 3억 원 미만" ~ 2.25,
    p036 == "5천만 원 ~ 1억 5천만 원 미만" ~ 1,
    p036 == "5천만 원 미만" ~ 0.25,
    p036 == "안계심(사망)" ~ 0,
    )
  )
# 백분위 구하고 잘 변경되나 확인
data %>% group_by(f011) %>% mutate(p036 = (rank(p036)/n()*100) %>% round(0)) %>% ungroup %>% select(f011,p036) %>% head(3)
```

```{r}
# 분위값으로 대체하기
data %<>% group_by(f011) %>% mutate(p036 = (rank(p036)/n()*100) %>% round(0)) %>% ungroup
```

## 문제 16

```{r}
data %>% select(p028z,p031z) %>% unique()
# 교육수준 교육년수로 전환하기
data %<>% mutate(p028z = case_when(
  p028z == "초졸이하" ~ 6,
  p028z == "중졸" ~ 9,
  p028z == "고졸" ~ 12,
  p028z == "전문대졸" ~ 14.5,
  p028z == "대졸" ~ 16,
  p028z == "대학원졸" ~ 18,
))
data %<>% mutate(p031z = case_when(
  p031z == "초졸이하" ~ 6,
  p031z == "중졸" ~ 9,
  p031z == "고졸" ~ 12,
  p031z == "전문대졸" ~ 14.5,
  p031z == "대졸" ~ 16,
  p031z == "대학원졸" ~ 18,
))
# 둘중 높은 값만 남기기
data %<>% mutate(edu = ifelse(p028z>=p031z,p028z,p031z))
# 입학년도 별 백분위 값으로 전환하기
data %<>% group_by(f011) %>% mutate(edu = (rank(edu)/n()*100) %>% round(0)) %>% ungroup
```
## 문제 17

```{r}
# 대졸이상 비율 구하기
data %<>% filter(p032!="모름/무응답") 
data %<>% group_by(p032) %>% mutate(pa032 = mean(p028z>=16)) %>% ungroup
data %<>% group_by(p033) %>% mutate(pa033 = mean(p031z>=16)) %>% ungroup
# 부모의 대졸이상 비율 평균 구하기
data %<>% mutate(job = (pa032+pa033)/2)
# 대졸이상 비율을 백분위 값으로 전환하기
data %<>% group_by(f011) %>% mutate(job = (rank(job)/n()*100) %>% round(0)) %>% ungroup
```

## 문제 18

```{r}
# 잘되나 확인용
data %>% mutate(total = (p034+p036+edu+job)) %>% group_by(f011) %>% mutate(total=(rank(total)/n()*100) %>% round(0)) %>% ungroup %>% select(total,f011)
```

```{r}
# 가족배경 종합지표 만들기
data %<>% mutate(total = (p034+p036+edu+job)) %>% group_by(f011) %>% mutate(total=(rank(total)/n()*100) %>% round(0) %>% divide_by(10)) %>% ungroup
```

## 보너스 문제 2

```{r}
pca_dt<-prcomp(data %>% select(p034,p036,edu,job),retx=TRUE)
plot(pca_dt,type="l")
```

```{r}
summary(pca_dt)
```
3번 째 축까지 이용하면 전체 분산의 89퍼센트를 설명할 수 있다. 분산을 가장 잘 설명하는 축은 PC1이다. 

```{r}
# 0과 100사이 값을 갖도록 min-max scaling하기
minmax <- function(x){
  return (100*(x-min(x))/(max(x)-min(x))) 
}
pc1<- pca_dt$x %>% as_tibble %>% select(PC1) %>% minmax 
```


```{r}
pca_dt
```

PC1은 전체 분산의 50퍼센트만을 설명함으로 단독으로 사용하기에는 애매하다고 생각한다. 또한 PC1의 선형결합의 계수를 보면 절대값의 크기가 모든 변수에서 비슷하다. 소득,자산,교육,직업 위계의 종합 점수 또한 평균값이므로 어떤 점에서는 어느정도 PC1을 반영해줄 수 있다고 생각한다. 따라서 가족배경 종합지표로 total을 선택한다. 

## 문제 19

```{r}
# 결측치 제거 f006이랑 f007이랑 결측치 행이 같아서 하나만 제거해도됨
data %<>% filter(!is.na(f006))
# f006 서울,경기도,기타광역시,기타광역도로 분류하기
gs <- c("부산","대구","인천","대전","광주","울산")
gd <- c("강원","경남","경북","전남","전북","제주","세종","충남","충북")
data %<>% mutate(f006 = case_when(
  (f006 == "서울")~"서울",
  (f006 %in% gs)~"기타광역시",
  (f006 %in% gd)~"기타광역도",
  (f006 == "경기")~"경기도"
))
# f006이 서울인 경우 f007이 강남구,서초구,송파구일 경우 1아니면 0
gn <- c("강남구","서초구","송파구")
data %<>% mutate(f007 = ifelse((f006 == "서울" & f007 %in% gn),1,0))
```

## 문제 20

```{r}
# f170 재분류
gitar <- c("실기위주","면접위주","서류위주","기타")
data %<>% mutate(f170 = case_when(
  (f170 %in% gitar) ~ "기타전형",
  (f170 == "학생부위주(교과)") ~ "내신위주",
  (f170 == "모름/무응답")~"기타전형",
  (f170 == "수능위주(정시모집)")~"수능위주",
  (f170 == "학생부위주(종합)(구 입학사정관제)")~"학생부종합",
  TRUE ~ f170
))
# f013 모름/무응답 --> 기타로 재분류
data %<>% mutate(f013 = case_when(
  f013 == "모름/무응답"~"기타",
  TRUE ~ f013
))
```


```{r}
# 조합 확인
data %>% select(f013,f170) %>% unique
```

수정해야 할 것

- f013 or f170 이 기타이면 무조건 기타
- f013이 정시인데, f170이 수능 위주가 아니면 무조건 기타
- f013이 수시인데, f170이 수능 위주면 무조건 기타

```{r}
# 위 조건에 맞춰 수정하는거 재대로 되나 확인 
data %>% mutate(enter = ifelse((f013=="기타" | f170=="기타전형"),"기타전형",
                               ifelse((f013=="정시모집" & f170!="수능위주"),"기타전형",
                                      ifelse((f013=="수시모집" & f170 =="수능위주"),"기타전형",f170)))) %>% select(f013,f170,enter) %>% unique
```

```{r}
# 위 조건에 맞춰 수정하는거 재대로 되나 확인 
data %<>% mutate(enter = ifelse(
  (f013=="기타" | f170=="기타전형"),"기타전형",
                               ifelse(
                                 (f013=="정시모집" & f170!="수능위주"),"기타전형",
                                      ifelse(
                                        (f013=="수시모집" & f170 =="수능위주"),"기타전형",f170)))) 
```

## 문제 21

```{r}
# 부모 사망 여부 사망시 1 생존시 0
data %<>% mutate(death1 = ifelse(p032=="안 계심(사망)",1,0),
                death2 = ifelse(p033=="안 계심(사망)",1,0))
# 재수, 삼수 이상한거 제거
data %<>%  mutate(jaesoo = f011-f001) %>% filter(jaesoo!=-1&jaesoo!=-2011)
# 재수, 삼수로 전환
data %<>% mutate(jaesoo = ifelse(jaesoo==1,"재수",
                                ifelse(jaesoo==2,"삼수",jaesoo)))
```

```{r}
# 출신 고교 유형 일반-인문계, 일반-자연계, 특목고-자사고, 기타 고교로 분류하기
# 결측치 제거
data %<>% filter(!is.na(f009)) 
# 재분류하기 
gitar <-c("특성화고(상업·정보계)",
          "특수목적고(예술고,체육고)",
          "특성화고(공업계)",
          "기타(방송통신고등학교, 대안학교 등)",
          "특성화고(농생명, 수산, 해양고 등)",
          "마이스터고등학교")
tmgjsg<-c("특수목적고(외국어고, 과학고, 국제고)",
          "자율 고등학교(자율형 사립고, 자율형 공립고)")
data %<>% mutate(f009 = ifelse(f009 %in% gitar,"기타고교",
                              ifelse(f009 %in% tmgjsg,"특목고-자사고",
                                     ifelse(f009=="일반계고(문과)","인문",
                                            "자연"))))
```


# Chpater2 Modeling

변수 정리

- Target : Y값
  - colnam : 엘리트 입학 여부 (Y)
- X 변수인 가족 배경은 사회경제적 배경과 출신 고등학교로 나눔
  - total : 가족 배경 중 사회 경제적 배경 (SES)
  - enter : 대학 입시 전형 유형 (AppType)
  - f006 : 고등학교 위치 
  - f007 : 출신 고등학교의 서울 강남 3구 여부
- 통제 변수 1 : 인구학적 변수
  - sex : 성별
  - p020 : 광역시도별 출생지역
  - birthy : 출생연도
  - death1 : 부친 부재 여부
  - death2 : 모친 부재 여부
- 통제 변수 2 : 기술 변수
  - f011 : 대학 입학 연도
  - jaesoo : 재수/삼수 여부
  - year : GOMS 조사 연도
- 통제 변수 3 : 출신 고교 유형
  - f009 : 출신 고교 유형


## 문제 1
```{r message=FALSE}
a1<-ggplot(data,aes(x=total,y=..density..,fill=factor(colnam))) + geom_histogram(alpha=0.5,color='black',position="dodge") + theme_classic()
a2<-ggplot(data) + geom_bar(aes(colnam,fill=enter),position = 'dodge') + theme_classic()
grid.arrange(a1,a2)
```

선형 확률 모델을 이용했을 때 발생할 수 있는 문제점은 다음과 같다.

- 선형확률 모형은 확률에 대한 변수들의 선형관계를 가정한다.

  - target Y값 0,1를 범주형 변수가 아닌 Y일 확률 100퍼센트, 0퍼센트로 여기면 $P(Y) = \beta_0 +\beta_1x_1+...+\beta_px_p$로 가정해볼 수 있다.
  - 그러나 직선의 특성상 확률의 범위인 0과 1을 넘어가게 되어 확률의 공리가 깨진다. 이러한 이유로 샘플 범위를 벗어나는 값에 대해 예측할 때 주의해야 한다.
  - 이분산성이 발생할 수 있다. 여기서 이분산성이란 잔차의 분산이 예측 값과 관련이 있는 현상을 의미한다. 선형 확률 모델의 경우, 예측 값이 커질수록 잔차의 분산도 커지는 경향이 있다.

- 종속 변수와 독립 변수 간의 관계가 선형이 아닐 수 있다. 

  -  y가 binary class 임으로 시각화 시 class 별로 특정 범주의 비율이 높다면 그 변수와 y가 양의 상관관계를 가질 것이라 판단 할 수 있다. 
  - 그러나 확실하게 구분이 되지 않는 범주에 대해서는 모델의 예측 성능이 떨어 질 수 있다.
  - 위는 일부를 시각화한 것인데, 확실하게 구분이 되지 않는 범주가 확인되는 것을 알 수 있다.
  
- 선형 모델은 이상치에 민감하게 반응 할 수 있다.

  - 이상치가 있는 경우 모델이 이상치의 영향으로 성능이 저하 될 수 있다.
  - 위에서 언급한 바와 같이 이상치와 같이 샘플들의 범위에서 크게 벗어나는 경우에 예측을 수행시 주의해야한다.



선형확률모델의 장점은 다음과 같다.

- 해석이 용이하다. 

  - 선형확률모델은 가중치의 해석이 쉽기 때문에, 데이터의 의미를 파악하는 데 유용하다.
  -  이 연구의 가설인 "입시전형에 관계없이 가족의 사회경제적 배경이 높을 수록 상위권 대학 진학의 확률이 커지고 그 정도는 입시전형마다 다르다."을 모델을 통하여 확인하고 해석하는 것임으로 예측력보다는 해석력에 더 초점을 두는 것이 맞다고 판단된다. 
  
- 연산이 빠르다

  - 최종적으로 사용하는 x데이터는 23983 * 13 으로 많다고 할 수는 없지만 적은 양도 아니다.
  - 솔직히 좀 억지인 감이있긴한데 이 정도면 많다고 치고 선형모델을 사용하면 다른 모델에 비해 상대적으로 빠르게 학습이 가능하다.
  

## 문제 2

```{r}
lg_model <- lm(colnam~total+enter+total*enter+f006+f007+sex+p020+birthy+death1+death2+f011+jaesoo+year+f009,data=data)
```

## 문제 3

연구 가설을 증명하기 위해서는 

1. 가족의 사회경제적 배경인 total(SES)와 입시전형 enter(AppType)이 유의해야 한다.
1. 또한 SES와 AppType의 교호작용이 유의해야 입시전형별로 정도의 차이가 있음을 확인 할 수 있다.

```{r}
summary(lg_model)
```

확인 해보면 total 변수와 enter 변수들이 유의한 것을 확인 할 수 있다.
total과 enter의 교호작용은 존재하지 않음으로 입시유형에 따른 정도의 차이는 없어보인다.


## 문제 4

```{r}
lg_model <- lm(colnam~total+enter+total*enter+f006+f007,data=data)
summary(lg_model)
```

Y에 영향을 미칠 수 있는 통제 변수를 고려하지 않으면 종속변수와 독립 변수 간의 관계가 왜곡될 수 있다. 위에서 통제변수를 뺀 상태로 모델을 학습 시켰을 경우 total의 추정된 계수가 커진것을 알 수 있다. 즉, 통제변수는 가설검증 시 관심이 있는 변수가 과대(과소) 추정되는 것을 방지한다.

## 문제 5

내생성 문제는 다음과 같은 원인으로 발생 할 수 있다.

- Y와 X에 동시에 영향력을 가지는 어떤 X*가 있는데 그것을 모델에 포함 시키지 않았을 때

- Y가 X에 역으로 영향을 미치는 경우

  - 이 경우는 Y의 에러값이 X에 영향을 미친다는 의미도 된다.
  
- measurement error가 존재할 경우.

SES변수가 내생성이 있는지 확인하고 있다면,

1. SES 변수가 잔차와 상관관계가 있는지를 파악해야하고

1. 상관관계가 존재한다면, 위의 3가지 원인을 고려해봤을 때

  - 관련된 다른 통제변수를 회귀모형에 추가하거나
  - SES 와는 상관관계가 존재하지만, 잔차와는 상관관계가 없는 변수를 추가할 수 있다.

## 보너스 문제 2

기존 가설에서 "그 정도는 입시전형마다 다르다." 를 확인 하기 위해 SES * AppType을 추가하였다. 즉, 새로운 가설  “가족의 사회경제적 배경이 높을수록 상위권 대학 진학의 확률이 커진다” 만 확인 하려면 현재 식에 추가되어있는 interaction term을 제거하면 되겠다.

## 보너스 문제 3

$$log(\frac{P(y=1)}{1-P(y=1)}) = \beta_0 +\beta_1x_1+...+\beta_px_p$$

로지스틱 회귀 모델 해석 시 발생할 수 있는 문제는 대부분 해석의 난해함에 대한 문제이다. 

 - 로지스틱 회귀 모델의 식을 확인해보면 회귀 계수는 확률에 선형적으로 영향을 미치지 않는다. 즉 해석이 매우 어렵다. 또한 interaction term이 있는 경우에는 계수 해석이 더욱더 어려워진다. 
 
 - odds 비는 $exp(\beta_0 +\beta_1x_1+...+\beta_px_p)$ 으로 구해지는데, 독립 변수의 한 단위 변화가 종속 변수의 오즈에 어떤 영향을 미치는 지를 나타내는 것임으로 우리가 알고 싶은 독립 변수가 종속 변수에 어떤 영향을 미치는 지에 대해 해석하기 어렵다.